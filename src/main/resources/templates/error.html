<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title>Error - DailyMood</title>

  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-slate-100 text-slate-800 min-h-screen">

<!-- Navbar -->
<div th:replace="~{fragments/navbar :: navbar}"></div>

<!-- Main container -->
<main class="max-w-3xl mx-auto mt-10 p-4">

  <section class="bg-white border border-red-300 rounded-2xl shadow-lg overflow-hidden"
           role="alert"
           aria-labelledby="error-title">

    <!-- Header -->
    <header class="bg-red-600 text-white px-6 py-4">
      <h1 id="error-title" class="text-xl font-bold">
        âš ï¸ Something went wrong!
      </h1>
    </header>

    <!-- Body -->
    <div class="p-6 space-y-4">

      <p class="text-lg font-medium text-red-700"
         th:text="${errorMessage}">
        Error message...
      </p>

      <p>
        Please check what you were doing or go back to the main page.
      </p>

      <!-- Actions -->
      <div class="flex flex-wrap gap-3 pt-2">

        <button type="button"
                onclick="history.back()"
                class="inline-flex items-center px-4 py-2 rounded-xl
                               bg-slate-600 text-white font-semibold
                               hover:bg-slate-700
                               focus:outline-none focus:ring-2 focus:ring-slate-400">
          â¬…ï¸ Go Back
        </button>

        <a th:href="@{/}"
           class="inline-flex items-center px-4 py-2 rounded-xl
                          bg-blue-600 text-white font-semibold
                          hover:bg-blue-700
                          focus:outline-none focus:ring-2 focus:ring-blue-400">
          ğŸ  Go to Home
        </a>

      </div>

      <!-- Toggle details -->
      <div class="pt-4">

        <button type="button"
                id="toggleDetails"
                aria-expanded="false"
                aria-controls="errorDetails"
                class="inline-flex items-center px-4 py-2 rounded-xl
                               border border-red-600 text-red-700 font-semibold
                               hover:bg-red-50
                               focus:outline-none focus:ring-2 focus:ring-red-400">
          ğŸ” Show Details
        </button>

        <!-- Error details -->
        <div id="errorDetails"
             class="hidden mt-4"
             role="region"
             aria-live="polite">

          <div class="bg-slate-100 border border-slate-300 rounded-xl p-4 overflow-auto max-h-64">
                        <pre class="text-sm text-slate-700 whitespace-pre-wrap"
                             th:text="${errorTrace}">
Stack trace will appear here...
                        </pre>
          </div>

        </div>
      </div>

    </div>
  </section>

</main>

<!-- Toggle script -->
<script>
  const toggleBtn = document.getElementById('toggleDetails');
  const details = document.getElementById('errorDetails');

  toggleBtn.addEventListener('click', () => {
    const expanded = toggleBtn.getAttribute('aria-expanded') === 'true';
    toggleBtn.setAttribute('aria-expanded', String(!expanded));
    toggleBtn.textContent = expanded ? 'ğŸ” Show Details' : 'ğŸ™ˆ Hide Details';
    details.classList.toggle('hidden');
  });
</script>

</body>
</html>
